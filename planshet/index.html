<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#000000">
<title>PhotoClock Launcher</title>
<link rel="manifest" href="manifest.json">

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: black;
  color: white;
  font-family: "Segoe UI", sans-serif;
}

#bg {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  z-index: 0;
}

.glass3d {
  --filter-glass3d: blur(15px) brightness(1) saturate(1);
  --color-glass3d: hsl(178 76% 16% / 0.1);
  --noise-glass3d: url("https://www.transparenttextures.com/patterns/egg-shell.png");

  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  box-shadow:
    0 0 0.75px hsl(205 20% 10% / 0.2),
    0.7px 0.8px 1.2px -0.4px hsl(205 20% 10% / 0.1),
    1.3px 1.5px 2.2px -0.8px hsl(205 20% 10% / 0.1),
    2.3px 2.6px 3.9px -1.2px hsl(205 20% 10% / 0.1),
    3.9px 4.4px 6.6px -1.7px hsl(205 20% 10% / 0.1),
    6.5px 7.2px 10.9px -2.1px hsl(205 20% 10% / 0.1),
    8px 9px 14px -2.5px hsl(205 20% 10% / 0.2);
}
.glass3d::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  border-radius: inherit;
  overflow: hidden;
  z-index: 3;
  -webkit-backdrop-filter: var(--filter-glass3d);
  backdrop-filter: var(--filter-glass3d);
  background-color: var(--color-glass3d);
  background-image: var(--noise-glass3d);
  background-size: 100px;
  background-repeat: repeat;
}
.glass3d::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  border-radius: inherit;
  overflow: hidden;
  z-index: 5;
  box-shadow:
    inset 2px 2px 1px -3px hsl(205 20% 90% / 0.8),
    inset 4px 4px 2px -6px hsl(205 20% 90% / 0.3),
    inset 1.5px 1.5px 1.5px -0.75px hsl(205 20% 90% / 0.15),
    inset 1.5px 1.5px 0.25px hsl(205 20% 90% / 0.03),
    inset 0 0 0.25px 0.5px hsl(205 20% 90% / 0.03);
}
.glass3d > * { position: relative; z-index: 6; }

#info {
  padding: 12px 20px;
  text-align: center;
  font-size: 20px;
}

#clock {
  font-size: 36px;
  font-weight: bold;
}

#date {
  font-size: 18px;
  opacity: 0.85;
  margin-top: 4px;
}

#weather {
  margin-top: 6px;
  display: flex;
  justify-content: center;
  gap: 40px;
  font-size: 18px;
}
#weather div {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}
#weather .temp {
  font-weight: bold;
}
#select-btn {
  position: absolute;
  top: 10px;
  left: 10px;
  background: rgba(0,0,0,0.4);
  border: none;
  color: white;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 14px;
}
</style>
</head>

<body>
<input type="file" id="fileInput" accept="image/*" hidden>
<button id="select-btn">Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾</button>
<img id="bg">

<div class="glass3d" id="glass">
  <div id="info">
    <div id="clock">00:00:00</div>
    <div id="date">1 ÑĞ½Ğ²Ğ°Ñ€Ñ 1970</div>
    <div id="weather">
      <div><div>ğŸŒ… Ğ£Ñ‚Ñ€Ğ¾</div><div class="temp" id="morn">--Â° (--Â°)</div></div>
      <div><div>ğŸŒ‡ Ğ”ĞµĞ½ÑŒ</div><div class="temp" id="day">--Â° (--Â°)</div></div>
      <div><div>ğŸŒ† Ğ’ĞµÑ‡ĞµÑ€</div><div class="temp" id="eve">--Â° (--Â°)</div></div>
      <div><div>ğŸŒƒ ĞĞ¾Ñ‡ÑŒ</div><div class="temp" id="night">--Â° (--Â°)</div></div>
    </div>
  </div>
</div>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}

const fileInput = document.getElementById('fileInput');
const bg = document.getElementById('bg');
const btn = document.getElementById('select-btn');

btn.onclick = () => fileInput.click();

fileInput.onchange = e => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = ev => {
    bg.src = ev.target.result; // base64 â€” Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾
  };
  reader.readAsDataURL(file);
};

// ğŸ•’ Ğ§Ğ°ÑÑ‹ Ğ¸ Ğ´Ğ°Ñ‚Ğ°
function updateClock() {
  const now = new Date();
  const h = String(now.getHours()).padStart(2, '0');
  const m = String(now.getMinutes()).padStart(2, '0');
  const s = String(now.getSeconds()).padStart(2, '0');
  document.getElementById('clock').textContent = `${h}:${m}:${s}`;

  const months = ["ÑĞ½Ğ²Ğ°Ñ€Ñ","Ñ„ĞµĞ²Ñ€Ğ°Ğ»Ñ","Ğ¼Ğ°Ñ€Ñ‚Ğ°","Ğ°Ğ¿Ñ€ĞµĞ»Ñ","Ğ¼Ğ°Ñ","Ğ¸ÑĞ½Ñ","Ğ¸ÑĞ»Ñ",
                  "Ğ°Ğ²Ğ³ÑƒÑÑ‚Ğ°","ÑĞµĞ½Ñ‚ÑĞ±Ñ€Ñ","Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ","Ğ½Ğ¾ÑĞ±Ñ€Ñ","Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ"];
  const d = now.getDate();
  const mo = months[now.getMonth()];
  const y = now.getFullYear();
  document.getElementById('date').textContent = `${d} ${mo} ${y}`;
}
setInterval(updateClock, 1000);
updateClock();

// ğŸŒ¦ ĞŸĞ¾Ğ³Ğ¾Ğ´Ğ° Ğ¿Ğ¾ ĞœĞ¾ÑĞºĞ²Ğµ
const API = "a4c685c23cd9f959b37857f2d6a3625f";
function updateWeather() {
  fetch(`https://api.openweathermap.org/data/2.5/forecast?q=Moscow&appid=${API}&units=metric&lang=ru`)
    .then(r => r.json())
    .then(data => {
      if (!data || !data.list) return;
      const times = {morn: 6, day: 12, eve: 18, night: 0};
      for (const [id, hour] of Object.entries(times)) {
        const entry = data.list.find(x => new Date(x.dt * 1000).getHours() === hour);
        if (entry) {
          const temp = Math.round(entry.main.temp);
          const feels = Math.round(entry.main.feels_like);
          document.getElementById(id).textContent = `${temp}Â° (${feels}Â°)`;
        }
      }
    })
    .catch(() => {});
}
updateWeather();
setInterval(updateWeather, 60 * 60 * 1000);
</script>
</body>
</html>
